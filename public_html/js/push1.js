(function(b,a){function h(c){a.pushNotifications?a.pushNotifications.getUserToken(c):c(null)}function k(c,e,d){h(function(a){if(a)try{d||(d=[]),l(d)||d.push({name:"pushToken",value:a})}catch(b){}a=JSON.stringify({params:d,eventTypeKey:c,keyValue:e});g(a)})}function l(c){try{var e=!1;c.forEach(function(c){c.name&&"pushToken"===c.name&&(e=!0)});return e}catch(a){return!1}}function g(c){var a=new XMLHttpRequest;a.onerror=function(){};a.open("POST","https://esputnik.com/api/v1/event",!0);a.withCredentials=!0;
a.setRequestHeader("Authorization","Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiI0NTI0ZWZhYTJkYzI2MGRmYTM4YTE1NDBlMWFjYjM0NmRiZmUyNzE3MzE0ZmMzOTYxOGFiNjA3OGRmODI0NTAxNjhhMmZjMzUwZWZiZWYyNDJhMTE3N2UzZDgyN2RhMmQwM2E0YmIwMjVhMzg3MmI5YWYyMjA1ZDIzNTFmYzYxNGIzYzBhZDM1MzQ3MzY2NGNiNzI1ZTk3YmU3OTM0OTExMDM4MmUwOWM5YzFiNjA1OWY1MDJhZjk2ZGMifQ.ahS7PYpnb3uQgLrOpsJTXqYG3IODmp5uGbEQa90u7Qz8oGThxi4XvhAjcmUrxHNNcDkL7X7yT6erzhHI3fVZZw");a.setRequestHeader("Content-Type","application/json");a.send(c)}b.esSdkObj?a=b.esSdkObj:b.esSdkObj=a;a.pushOn=function(){a.pushNotifications?a.pushNotifications.init():console.log("Push module unavailable")};a.sendEvent=function(a,e,d){k(a,e,d)};a.getPushToken=h})(this,this.esSdkObj||{});
var la=function(y,p){function z(){try{!f.b||f.b&&c.main.IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS?N():f.b&&!c.main.IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS?O.J():b.error("[registerController()] NO ACTIONS !!!")}catch(a){b.log("[registerController()] handle error ",a)}}function E(){b.log("[init()] Started..");c.main.USE_CLIENT_PROXY_FOR_SPECIAL_HTTPS&&(b.log("[setupUrlFiles()] Starting"),c.urls.APP_MANIFEST_URL_HTTPS="/push/resource/"+c.main.APPLICATION_ID+c.urls.APP_MANIFEST_URL_HTTPS,
c.urls.SERVICE_WORKER_URL_HTTPS="/push"+c.urls.SERVICE_WORKER_URL_HTTPS,b.log("[setupUrlFiles()] OK:",c.urls.APP_MANIFEST_URL_HTTPS,c.urls.SERVICE_WORKER_URL_HTTPS));b.log("[injectManifest()] Started..");var a=document.createElement("link");a.rel="manifest";a.href=c.urls.APP_MANIFEST_URL_HTTPS;document.head.appendChild(a);b.log("[injectManifest()] OK");f.platform=t.v();f.userAgent=t.B();f.b=t.b();f.isSupported=t.I();f.c=t.H();b.log("[init()] Environment: ",f);b.log("")}function P(){b.log("[checkSubscriptionInGCM()] Started.. ");
navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){b.log("[checkSubscriptionInGCM()] OK, subscription =",a);a?(a=F(a),q.f(a)):G()})["catch"](function(a){b.error("[checkSubscriptionInGCM()] FAIL: ",a)})})}function G(){b.log("[subscribe()] Started...");if("safari"===f.userAgent.name.toLowerCase()){var a=window.i.h.permission(SAFARI_WEBSITE_PUSHID);if("granted"===a.permission){q.f(a.N);return}}navigator.serviceWorker.ready.then(function(a){a.pushManager.subscribe({userVisibleOnly:!0}).then(function(a){b.log("[subscribe()] OK, subscribe =",
a);a=F(a);q.f(a)})["catch"](function(a){b.warn("[subscribe()] FAIL: ",a)})})}function F(a){b.log("[parseSubscriptionEndpoint()] Started... ");a=a.subscriptionId?a.subscriptionId:a.endpoint;b.log("[parseSubscriptionEndpoint()] OK, subscriptionEndpoint = ",a);return a}function Q(a){b.log("Safari permissions: ");b.log(a);"default"===a.permission?window.i.h.requestPermission(SAFARI-SERVICE-URL,c.main.APNS_WEBSITE_PUSHID,{L:APNS_APP_ID},checkSafariPermission):"denied"===a.permission?b.log("User refused push notifications"):
"granted"===a.permission&&(b.log("User allow push notifications"),G())}function A(){var a=document.getElementById("ScMail");return a?a.innerHTML.trim():null}function R(a,b){h.get("Email",function(d){d.target.result?b(a,d.target.result.value):b(a,null)},function(){b(a,null)})}function S(a,e){var d=A();d&&e!==d&&q.j(a,"5",d,function(a,e){try{a&&e&&h.a({key:"Email",value:d})}catch(c){b.error("[bind()] ",c)}})}function T(a){h.get("updates",function(e){try{var d=e.target.result;e=null;null!=d&&(e=new Date(d.value));
a(e)}catch(g){b.log("Error: ",g)}})}function U(a){try{T(function(b){if(null!=b&&x(b,new Date)<c.updates.tokenDataUpdatePeriod)return a(!1);a(!0)})}catch(e){b.log("Error: ",e)}}function V(){var a="",b=!1,d=null,g=unescape(H("__utmz"));if(""!=g&&(g=g.split("."),4<=g.length)){g=g[4].split("|");for(i=0;i<g.length;i++)0<=g[i].indexOf("utmcsr=")&&-1!=g[i].substring(g[i].indexOf("=")+1).indexOf("eSputnik")&&(b=!0),0<=g[i].indexOf("utmcct=")&&(d=g[i].substring(g[i].indexOf("=")+1));b&&d&&(a=d)}return a}function W(){var a=
r.g("es-utm-content");0===a%1||(a="");return a}function X(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var d=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?d:d&3|8).toString(16)})}function N(){b.log("[showCustomPopOverDialogController()] Starting...");u.G(h,Y);try{Z(function(a,e){a&&aa(function(a){try{a||ba(function(a){try{if(a){var d=new Date(e),n=new Date;x(d,n)>864E5*c.subscription.timeBlockPopover&&u.m()}else{var n=new Date;
(!e||x(e,n)>1E3*c.subscription.timeoutIgnorePopover)&&u.m()}}catch(ca){b.error("check before iframe",ca)}})}catch(g){b.error("check before iframe",g)}})})}catch(a){b.error("check before iframe",a)}}function Z(a){h.get("userPrompted",function(e){var d=null;void 0===e.target.result?b.log("New visitor, try to subscribe ..."):void 0!==e.target.result.value&&(d=new Date(e.target.result.value.date));a(!0,d)},function(){a(!1,null)})}function ba(a){h.get("refused",function(b){a(b.target.result)},function(e){b.log("Failed to retrieve refused key, error: "+
e.target.errorCode);a(null)})}function aa(a){h.get("SID",function(b){a(b.target.result)},function(e){b.log("Failed to retrieve ID key, error: "+e.target.errorCode);a(null)})}function Y(){try{b.log("Subscription denied"),h.a({key:"refused",value:(new Date).toString()})}catch(a){}}function x(a,b){return b.getTime()-a.getTime()}function I(a,b,d){var g=new Date;g.setTime(g.getTime()+864E5*d);document.cookie=a+"="+b+"; path=/;"+("expires="+g.toUTCString())}function H(a){var b="";a+="=";for(var d=document.cookie.split(";"),
g=0;g<d.length;g++){for(var c=d[g];" "==c.charAt(0);)c=c.substring(1);0==c.indexOf(a)&&(b=c.substring(a.length,c.length))}return b}function J(a,e){function d(a,e,d){b.log("[sendResultCallback()] save to indexedDb..");b.log("[sendResultCallback()]",a,e,d);try{a&&d?(b.log("[sendResultCallback()] Starting save token to indexedDb:",d.token),h.a({key:"SID",value:{sid:d.token,bnd:e}}),d.bindings?(b.log("[sendResultCallback()] Starting save to indexedDb:",d.bindings),d.bindings.forEach(function(a){1==a.type?
h.a({key:"Contacts",value:a.value}):2==a.type?I("es-bind-id",a.value,1095):3==a.type?h.a({key:"sw-md5",value:{hash:a.value,date:(new Date).toString()}}):5==a.type&&h.a({key:"Email",value:a.value})})):b.warn("[sendResultCallback()] return, data.bindings = ",d.bindings)):b.warn("[sendResultCallback()] return, subscription not saved")}catch(c){b.error("[syncSubscription()]",c)}}b.log("[syncSubscription()]",a,e);h.get("SID",function(c){try{if(!c.target.result)K(a,e,d);else if(c.target.result.value!==
a){var k=c.target.result.value;b.warn("[[syncSubscription()]] old data in indexedDB",k,a);L(k,a,0,d)}}catch(f){b.error("[syncSubscription()]",f)}},function(){b.error("Failed to get SID data")})}function K(a,e,d){b.log("[sendSubscriptionToService()]",a,e);try{var g=new XMLHttpRequest;g.onreadystatechange=function(){try{4==g.readyState&&(200==g.status?d(!0,!0,JSON.parse(g.responseText)):409==g.status?d(!0,!0,JSON.parse(g.responseText)):(b.warn("Bad Response status = ",g),d(!1,!1,null)))}catch(a){b.error("[sendSubscriptionToService()]",
a)}};g.open("PUT",c.main.notificationsService+"/v1/subscribe/",!0);g.setRequestHeader("Content-Type","application/json");e={};e.domainId=c.main.APPLICATION_ID;e.endpoint=a;e.userAgent=f.userAgent.name;e.userAgentVersion=f.userAgent.version;e.userAgentLanguage=window.navigator.K||window.navigator.language;e.OS=f.platform;e.subscriptionPage=window.location.href;e.binding=da();g.send(JSON.stringify(e))}catch(k){b.error("[sendSubscriptionToService()]",k)}}function da(){var a={};""!=l?(a.type="1",a.value=
l):A()?(a.type="5",a.value=A()):""!=m&&(a.type="2",a.value=m);return a}function M(a,e,d,g){b.log("[sendBindRequestToService()] Starting...");try{var k=new XMLHttpRequest;k.onreadystatechange=function(){try{4===k.readyState&&(200==k.status?g(!0,k.responseText):g(!1,null))}catch(a){b.error("[sendBindRequestToService()]",a)}};k.open("PUT",c.main.notificationsService+"/v1/bind/",!0);k.setRequestHeader("Content-Type","application/json");k.send(JSON.stringify({token:a,type:e,value:d}))}catch(f){b.error("[sendBindRequestToService()]",
f)}}function L(a,e,d,c){b.log("Send updated subscription to server:"+e);b.log("Old subscription:"+a);c(!0,null)}function ea(a,e){b.log("[sendUpdateTokenDataRequestToService()] Starting...");try{var d=new XMLHttpRequest;d.onreadystatechange=function(){try{4===d.readyState&&(200==d.status?e(!0):e(!1))}catch(a){b.error("[sendBindRequestToService()]",a)}};d.open("POST",c.main.notificationsService+"/v1/subscription/"+a+"/data/update",!0);d.setRequestHeader("Content-Type","application/json");d.send(JSON.stringify({userAgentVersion:f.userAgent.version,
userAgentLanguage:window.navigator.K||window.navigator.language,OS:f.platform}))}catch(g){b.error("[sendUpdateTokenDataRequestToService()]",g)}}function fa(a){h.get("validation",function(e){try{var d=e.target.result;e=null;null!=d&&(e=new Date(d.value));a(e)}catch(c){b.log("Error: ",c)}})}function ga(a){fa(function(b){if(null!=b&&x(b,new Date)<c.validation.validationPeriod)return a(!1);a(!0)})}function ha(a,e,d){try{ga(function(g){if(g){var k=new XMLHttpRequest;k.onreadystatechange=function(){try{4==
k.readyState&&200==k.status&&(B="true"===k.responseText?!0:!1,b.log("Is token valid: "+B),B?d():ia(a,e),h.a({key:"validation",value:(new Date).toString()}))}catch(c){b.log("Failed to update service worker: "+c)}};null!=a&&(k.open("GET",c.main.notificationsService+"/v1/subscription/validate?value="+a,!0),k.setRequestHeader("Content-Type","application/json"),k.send())}else d()})}catch(g){b.log("Error: "+g)}}function ia(a,e){var d=new XMLHttpRequest;d.onreadystatechange=function(){try{4==d.readyState&&
200==d.status&&(b.log("Token is set to inactive"),h.remove("SID",function(){b.log("SID key is removed from storage");e()},function(a){b.log("Failed to remove subscription info from storage: "+a.target.errorCode)}))}catch(a){b.log("Failed to deactivate token: "+a)}};d.open("PUT",c.main.notificationsService+"/v1/subscription/"+a+"/inactive",!0);d.setRequestHeader("Content-Type","application/json");d.send()}y.esSdkObj||(y.esSdkObj={});y.esSdkObj.pushNotifications=p;var c={main:{targetDomain:"https://iteam.ru",
proxyDomain:"https://web-push.esputnik.com",APPLICATION_ID:"3F91BF2B-DFF3-4947-BF3E-A7F92ADFC673",notificationsService:"https://push.esputnik.com",APNS_WEBSITE_PUSHID:"1",IS_SHOW_SPECIAL_FOR_HTTPS:true,USE_CLIENT_PROXY_FOR_SPECIAL_HTTPS:false,IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS:!1},subscription:{timeSuccessShow:8,timeoutIgnorePopover:0,timeBlockPopover:7,SHOW_PROMPT_DELAY:0,
promptMode:1,subscriptionPromptAcceptBtnText:"Разрешить",subscriptionPromptDeclineBtnText:"Запретить",subscriptionPromptText:"Кликните &quot;Разрешить&quot; чтобы получать уведомления от https://iteam.ru",subscriptionPopoverType:2},validation:{validationPeriod:86400000,isValidationEnabled:false,validationWindowWidth:500,validationWindowHeight:300},
updates:{tokenDataUpdatePeriod:1800000},urls:{APP_MANIFEST_URL_HTTPS:"/manifest.json",SERVICE_WORKER_URL_HTTPS:"/sw.js"},logging:{IS_LOGGER_ENABLED:"false"}},l="",m="",B=!1,ja={onPageLoad:1,byElementClick:2},C={"default":1,topPanel:2,bottomPanel:3},f={platform:null,userAgent:null,isSupported:!1,b:!1,c:!1},O={R:z,J:function(){b.log("[registerServiceWorker()] Started...");if("safari"===f.userAgent.name.toLowerCase()){var a=window.i.h.permission(SAFARI_WEBSITE_PUSHID);
Q(a)}else"serviceWorker"in navigator&&navigator.serviceWorker.register(c.urls.SERVICE_WORKER_URL_HTTPS,{scope:"./"}).then(function(a){b.log("[registerServiceWorker()] sw registered for scope: ",a.scope);b.log("[registerServiceWorker()] OK:",a);b.log("");P()})["catch"](function(a){b.error("[registerServiceWorker()] FAIL:",a)})}},ka={bind:function(){b.log("[bind()] Starting...");(l=W())&&""!=l||(l=V());m=r.g("es-bind-id");b.log("[bind()] userId =",l);b.log("[bind()] uuid =",m);var a=!1;""===l&&""===
m&&(m=X(),a=!0);h.get("SID",function(e){function d(){q.j(n,"1",l,function(a,d){try{a&&d&&h.a({key:"Contacts",value:d})}catch(c){b.error("[bind()] ",c)}})}function g(a){U(function(d){b.log("UPDATE NEEDED: "+d);d&&ea(a,function(a){a&&h.a({key:"updates",value:(new Date).toString()})})})}function k(){h.get("Contacts",function(a){try{if(a.target.result){var c=a.target.result.value;""!==l&&l!=c&&d()}else""!==l?d():R(n,S)}catch(e){b.log("[bind()] ",e)}});a&&M(n,"2",m,function(a,d){b.log("    [sendBindRequestToService()] [save cookie callback] Starting");
try{a&&d?(m=d,r.l("es-bind-id",d,1095)):r.u("es-bind-id")}catch(c){b.error("[sendBindRequestToService()] [save cookie callback] ",c)}});g(n)}b.log("[bind()] Starting...");b.log("[bind()]  Check SID in DB: ",e.target.result);if(e.target.result){var n=e.target.result.value.sid;c.validation.isValidationEnabled&&!f.b?(b.log("validate"),ha(n,z,k)):(b.log("validation disabled"),k())}else b.log("[bind()] No SID in DB, try to register"),z()},function(){b.log("Failed to get data")});b.log("[bind()] Finish");
b.log("")}},r={g:H,l:I,u:function(){document.cookie=name+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},q={T:K,j:M,U:L,f:J,S:function(){b.log("Try Register User Visit");h.get("SID",function(a){b.log("Check SID in DB: ",a.target.result);a.target.result?(b.log("Register User Visit"),a=a.target.result.value.sid,esSdkObj.O("user_visited_site",a,[{name:"sid",value:a}])):b.log("No SID in DB")})}},b={log:function(){console&&b.isEnabled()&&console.log.apply(console,arguments)},warn:function(){console&&b.isEnabled()&&
console.warn.apply(console,arguments)},error:function(){console&&b.isEnabled()&&console.error.apply(console,arguments)},isEnabled:function(){return/true/.test(c.logging.IS_LOGGER_ENABLED)}},t={P:E,B:function(){var a,b=navigator.userAgent,d=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],c=b.match(/(edge(?=\/))\/?\s*(\d+)/i)||[];return"Edge"===c[1]?{name:c[1],version:c[2]}:/trident/i.test(d[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],{name:"IE",version:a[1]||""}):"Chrome"===d[1]&&
(a=b.match(/\bOPR\/(\d+)/),null!=a)?{name:"Opera",version:a[1]}:(d=d[2]?[d[1],d[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(a=b.match(/version\/(\d+)/i))&&d.splice(1,1,a[1]),{name:d[0],version:d[1]})},v:function(){var a="";"Windows FreeBSD Android iPhone Linux Mac".split(" ").forEach(function(b){-1!=navigator.userAgent.indexOf(b)&&(a=b)});return a},b:function(){var a=window.location.protocol;return c.main.IS_SHOW_SPECIAL_FOR_HTTPS&&"https:"===a?!0:!1},I:function(){if("iOS"===f.platform||
"Android"===f.platform)return!1;if("chrome"===f.userAgent.name.toLowerCase()&&42<=parseFloat(f.userAgent.version)||"firefox"===f.userAgent.name.toLowerCase()&&44<=parseFloat(f.userAgent.version))return!0;if("safari"===f.userAgent.name.toLowerCase())return!1},H:function(){var a=window.location.href;-1===c.main.targetDomain.indexOf("://www.")&&(a=a.replace("://www.","://"));return 0===a.indexOf(c.main.targetDomain)}},D={F:E,s:function(){b.log("[checkData()] Started..");f.isSupported||b.warn("[checkData()] FAIL, Environment is not supported:",
f);f.c||b.warn("[checkData()] FAIL,this  is not target domain",f);b.log("[checkData()] Ok");b.log("")},o:function(a){var c=null;b.log("[init()] check utm labels:",window.location.search);window.location.search.replace(/^\?/,"").split("&").forEach(function(d){d=d.split("=");a==d[0]&&(c=d[1],b.log("[init()] contactId from url =",c),0===c%1&&r.l("es-utm-content",c,1095))})}};p.init=function(){try{var a=function(){try{D.F(),D.s(),f.isSupported&&f.c&&(D.o("utm_content"),ka.bind())}catch(a){b.log("[main()] handle error ",
a)}};b.log("Configuration: ");b.log("Target Domain: ",c.main.targetDomain);b.log("Proxy Domain: ",c.main.proxyDomain);b.log("Application ID: ",c.main.APPLICATION_ID);b.log("Notifications Service: ",c.main.notificationsService);b.log("Apple Push Notification Website Push ID: ",c.main.APNS_WEBSITE_PUSHID);b.log("Show Subscription IFrame Result [s]: ",c.subscription.timeSuccessShow);b.log("Timeout on ignore prompt: ",c.subscription.timeoutIgnorePopover);b.log("Timeout on block prompt: ",c.subscription.timeBlockPopover);
b.log("Validation period: ",c.validation.validationPeriod);b.log("Is Validation Enabled: ",c.validation.isValidationEnabled);b.log("Validation Window Width: ",c.validation.validationWindowWidth);b.log("Validation Window Height: ",c.validation.validationWindowHeight);b.log("Token Data Update Period: ",c.updates.tokenDataUpdatePeriod);b.log("Is show special for Https: ",c.main.IS_SHOW_SPECIAL_FOR_HTTPS);b.log("Use client proxy for special Https: ",c.main.USE_CLIENT_PROXY_FOR_SPECIAL_HTTPS);b.log("App Manifest URL: ",
c.urls.APP_MANIFEST_URL_HTTPS);b.log("Service Worker URL: ",c.urls.SERVICE_WORKER_URL_HTTPS);b.log("Show IFrame for Https: ",c.main.IS_SHOW_CUSTOM_POP_OVER_DIALOG_FOR_SPECIAL_HTTPS);b.log("Show Prompt Delay: ",c.subscription.SHOW_PROMPT_DELAY);b.log("Is logger enabled: ",c.logging.IS_LOGGER_ENABLED);c.subscription.promptMode===ja.onPageLoad?setTimeout(a,1E3*c.subscription.SHOW_PROMPT_DELAY):document.addEventListener("click",function(c){-1<c.target.className.split(" ").indexOf("es-push-prompt-init")&&
(b.log("init subscription by click"),a())},!1)}catch(e){b.log("[init] handle error ",e)}};p.getUserToken=function(a){h.get("SID",function(b){var c=null;b.target.result&&(c=b.target.result.value.sid);a(c)})};var h=function(){function a(a,c){try{var e=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open("es-push-integration",1);e.onsuccess=function(b){try{d=b.target.result,a()}catch(c){}};e.onerror=function(a){try{b.log("DB opening error: "+a.target.errorCode),c()}catch(d){}};
e.onupgradeneeded=function(a){try{a.target.result.createObjectStore("integration-data",{keyPath:"key"})}catch(b){}}}catch(f){}}function c(e){try{d?e():a(function(){e()},function(){b.log("DB init failed")})}catch(f){b.log("Error occurred: "+f)}}var d=null;return{a:function(a,b,f){c(function(){var c=d.transaction(["integration-data"],"readwrite").objectStore("integration-data").put(a);c.onsuccess=b;c.onerror=f})},remove:function(a,b,f){c(function(){var c=d.transaction(["integration-data"],"readwrite").objectStore("integration-data")["delete"](a);
c.onsuccess=b;c.onerror=f})},get:function(a,b,f){c(function(){var c=d.transaction(["integration-data"],"readonly").objectStore("integration-data").get(a);c.onsuccess=b;c.onerror=f})}}}(),u=function(){function a(){var a=document.getElementsByTagName("head")[0],e=document.createElement("link");e.rel="stylesheet";e.type="text/css";e.href=c.main.notificationsService+"/resource/"+c.main.APPLICATION_ID+"/es-subscription-prompt-style.css";a.appendChild(e);window.addEventListener("message",function(a){try{if(0==
a.origin.indexOf(c.main.proxyDomain))if("pong"==a.data)clearInterval(q),d();else if("SYNC"==a.data)p.a({key:"synced",value:(new Date).toString()});else{var e=1E3*c.subscription.timeSuccessShow;if("refused"==a.data)t();else if(0===a.data.indexOf("SID|")){var g=a.data.split("|");2==g.length&&J(g[1])}setTimeout(function(){try{null!=v&&v.close()}catch(a){b.error("iframe: ",a)}},e)}}catch(f){b.error("iframe: ",f)}},!1)}function e(){try{var a="push-notification-popover",e="push-notification-prompt-buttons";
c.subscription.subscriptionPopoverType===C.topPanel?(a="push-notification-popover-top",e="push-notification-prompt-inline-buttons"):c.subscription.subscriptionPopoverType===C.bottomPanel&&(a="push-notification-popover-bottom",e="push-notification-prompt-inline-buttons");var f=document.createElement("div");f.setAttribute("class","push-notification-prompt "+a);var h=document.createElement("div");h.setAttribute("class","push-notification-prompt-message");var k=document.createElement("div"),l=document.createElement("img");
l.setAttribute("class","push-notification-bell-icon");l.setAttribute("width","14");l.setAttribute("height","14");l.setAttribute("src",c.main.notificationsService+"/img/subscription-notify-icon.svg");k.appendChild(l);k.setAttribute("class","push-notification-prompt-message-text");var m=document.createElement("div");m.setAttribute("class",e);var n=document.createElement("button");n.setAttribute("class","push-notification-prompt-btn push-notification-accept-btn");n.setAttribute("type","button");n.onclick=
g;n.innerHTML=c.subscription.subscriptionPromptAcceptBtnText;var p=document.createElement("button");p.setAttribute("class","push-notification-prompt-btn push-notification-disallow-btn");p.setAttribute("type","button");p.onclick=function(){t();d()};p.innerHTML=c.subscription.subscriptionPromptDeclineBtnText;m.appendChild(p);m.appendChild(n);h.appendChild(k);if(c.subscription.subscriptionPopoverType===C["default"]){h.appendChild(m);var q=document.createElement("div");q.setAttribute("class","push-prompt-text");
q.innerHTML=c.subscription.subscriptionPromptText;k.appendChild(q)}else k.innerHTML+=c.subscription.subscriptionPromptText,k.appendChild(m);f.appendChild(h);var r=document.createElement("span");r.setAttribute("class","close-prompt");r.onclick=function(){d()};h.appendChild(r);f.style.visibility="hidden";return f}catch(u){return b.error("iframe: ",u),null}}function d(){try{null!=w&&(w.style.visibility="hidden")}catch(a){b.error("iframe: ",a)}}function g(){try{v=window.open(c.main.proxyDomain+"/subscription/"+
c.main.APPLICATION_ID,"_blank","scrollbars=yes, width=500, height=500, top="+(h()/2-250+m())+", left="+(f()/2-250+l())),window.focus&&v.focus(),q=setInterval(function(){try{v.postMessage("ping",c.main.proxyDomain),v.postMessage("callFrom|"+window.location.href,c.main.proxyDomain)}catch(a){d()}},100)}catch(a){b.error("iframe: ",a)}}function f(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width}function h(){return window.innerHeight?
window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height}function l(){return void 0!==window.screenLeft?window.screenLeft:screen.left}function m(){return void 0!==window.screenTop?window.screenTop:screen.top}var v=null,t=null,w=null,q=null,r=null,p=null;return{G:function(c,d){try{b.log("UI Module Init."),a(),w=e(),null!=w&&document.body.appendChild(w),p=c,t=d}catch(f){b.error("iframe: ",f)}},m:function(){try{p.a({key:"userPrompted",value:{date:(new Date).toString()}}),
w.style.visibility="visible"}catch(a){b.error("iframe: ",a)}},V:function(){try{var a=u.D(),d=u.C(),e=a/2-c.validation.validationWindowWidth/2+u.w(),f=d/2-c.validation.validationWindowHeight/2+u.A();r=window.open(c.main.proxyDomain+"/resource/update-frame/"+c.main.APPLICATION_ID,"_blank","location=no, scrollbars=no, width="+c.validation.validationWindowWidth+", height="+c.validation.validationWindowHeight+", top="+f+", left="+e);r.blur();window.focus()}catch(g){b.log("Error: "+g)}},M:d,D:f,C:h,w:l,
A:m}}();return p}(this,la||{});
(function(b,a){function h(){for(var a=b[g].q;0<a.length;)k(a)}function k(a){try{if(0!=a.length){var e=a.shift(),d=e[0];a=[];for(var b=1;b<e.length;b++)a.push(e[b]);l(d,a)}}catch(g){}}function l(c,b){for(f in a)if(a.hasOwnProperty(f)){var d=a[f];if(f===c){d.apply(this,b);break}}}var g=b.esSdk;b[g]?(b[g].q.push=function(){var a=Array.prototype.push.apply(this,arguments);k(b[g].q);return a},h()):console.log("Using SDK synchronously")}(this,this.esSdkObj));